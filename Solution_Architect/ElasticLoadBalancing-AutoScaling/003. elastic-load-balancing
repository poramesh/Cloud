Amazon Elastic Load Balancing (ELB)


Purpose:

Provides high availability and fault tolerance by distributing incoming traffic to multiple instances.
Acts as a single endpoint (DNS name or IP address) behind which multiple EC2 instances (or other targets) sit.

Supported Targets:

EC2 instances
ECS containers
IP addresses
Lambda functions
Other load balancers (can be chained together)


Key Features:

Automatic Distribution:
Distributes traffic to targets (EC2 instances, containers, etc.) across multiple availability zones.

Health Checks:
ELB performs health checks on targets (e.g., checks HTTP port 80 for a 200 status code).
If a target fails the health check, it is marked as unhealthy, and the traffic is redirected to healthy targets.

Auto Scaling Integration:
Auto scaling works with ELB to replace unhealthy instances automatically. When ELB detects a failure, it triggers auto scaling to launch new instances.

Fault Tolerance:
Even if an instance or availability zone fails, traffic is redistributed to healthy instances in other zones.



Types of Load Balancers:

1. Application Load Balancer (ALB):

Layer 7 Load Balancer: Works with HTTP/HTTPS traffic and looks at the HTTP headers.

Features:
Path-based routing (e.g., /orders vs /myaccount).
Host-based routing (routing based on domain names).
Good for web applications, microservices, and Docker containers.
Supports Lambda functions as targets.
Use for microservices architectures or applications requiring detailed routing.


Use Cases:

Use for web applications (HTTP/HTTPS).
Useful for microservices architectures like Docker containers.
Supports Lambda as a target.
Good for complex routing needs (path-based, host-based).


performances:

While ALB can handle high traffic, it’s not as fast as NLB in terms of raw performance, since it operates at the 
application layer and makes more complex routing decisions.
It can handle more complex routing logic but may introduce slightly higher latencies compared to NLB.

Routing capabilities:

Advanced routing: Routes based on content, such as URL paths, HTTP headers, HTTP methods, query strings, and hostnames.
Can perform path-based routing (e.g., routing /api traffic to one backend and /static to another) or host-based routing
(e.g., routing example.com traffic to one backend and api.example.com to another).
Supports SSL termination and WebSocket connections.


SSL Termination:

Supports SSL/TLS termination, meaning the ALB can decrypt the HTTPS traffic and forward it to backend servers as HTTP, reducing the load on the backend instances.


Health checks:

Supports HTTP/HTTPS health checks (checking if an application responds with a specific HTTP status code, like 200 OK).
Provides more granular checks for application health based on HTTP responses.

IP adressing

ALB is DNS-based, so it doesn’t use static IP addresses. Instead, it uses a DNS name to resolve the IP addresses of the load balancer.
Typically used for web applications where you don't need fixed IPs.


WebSocket Support:

Fully supports WebSockets, making it suitable for real-time applications like chat applications or live updates.


cost:

ALB might incur higher costs in scenarios with complex routing or when handling large volumes of HTTP/HTTPS traffic due to the additional features and capabilities provided.




2. Network Load Balancer (NLB):

Layer 4 Load Balancer: Works with TCP/UDP traffic, looking at port numbers (Layer 4 protocols).

Features:
Operates at Layer 4 (Transport Layer) of the OSI model.
It works with TCP and UDP traffic and forwards traffic based on IP protocol data (e.g., source and destination IP address, and port).
NLB is designed for high-performance, low-latency scenarios where you need to forward raw network packets.

Use Cases:

Best suited for high-throughput, low-latency applications that require support for TCP/UDP traffic.
Ideal for applications that deal with non-HTTP protocols, such as gaming, IoT, real-time
communications, or other network-based services.
Suitable for hybrid cloud or on-premises applications that need to forward traffic
without deep inspection of the application layer.

Performance:

High performance: Designed to handle millions of requests per second while maintaining low latencies.
Ideal for workloads that require very fast, efficient packet forwarding with minimal processing.

Routing Capabilities:

Simple routing: Routes based on IP protocol and port.
It does not inspect the content of the traffic and forwards requests based on basic network attributes.


SSL Termination:

Does not support SSL termination. If you need to use SSL/TLS, you must handle the encryption/decryption on your application or at the EC2 instances themselves.


Health Checks:

Supports TCP health checks (checking if a port is open and available).
It doesn't inspect the application response, only checking if the network connection is healthy.

IP Adressing:

NLB has the ability to assign static IP addresses to the load balancer, making it more predictable for applications that require fixed IP addresses.
It also supports Elastic IPs (EIP) for high availability.

WebSocket Support:

Does not support WebSockets natively. It can forward traffic to WebSocket servers but requires TCP-level handling.

Cost:

Generally, NLB can be more cost-effective in scenarios that require low-latency and high throughput, especially when using simple TCP/UDP routing.


Feature	Network            Load Balancer (NLB)   	                            Application Load Balancer (ALB)
OSI Layer	                 Layer 4 (TCP/UDP)	                                Layer 7 (HTTP/HTTPS)
Protocols                  Supported	TCP, UDP	                              HTTP, HTTPS, WebSocket
Routing Type	             Based on IP and port	                              Based on URL, headers, hostnames, query parameters
SSL Termination	           No	                                                Yes
Health Checks	             TCP-based	                                        HTTP/HTTPS-based
WebSocket Support	         No	                                                Yes
IP Addressing	Supports     static IP and Elastic IP	                          DNS-based
Use Case	                 High-performance, low-latency, non-HTTP traffic	  Web applications, content-based routing
Cost	                     Generally lower for simple use cases          	    Typically higher due to additional features


When to Use Which?

Network Load Balancer (NLB):
If you need to handle high throughput and low-latency, TCP/UDP traffic.
Ideal for non-HTTP applications (e.g., real-time applications, gaming, IoT).
Requires static IP addresses and simpler network-based routing.

Application Load Balancer (ALB):
If your application is web-based and needs content-based routing or advanced routing logic.
Ideal for HTTP/HTTPS applications, including microservices architectures.
Supports SSL termination, WebSockets, and more granular health checks.


3, Gateway Load Balancer (GLB):

Used for load balancing traffic to virtual appliances (e.g., firewalls, intrusion detection/prevention systems).
Uses the Geneve protocol for inspecting incoming traffic.
Provides centralized inspection and monitoring for third-party virtual network appliances.

Use Cases:

Deploy for virtual network appliances (firewalls, IDS/IPS, deep packet inspection).
Use when you need centralized traffic inspection and monitoring.


Conclusion:
Elastic Load Balancing ensures high availability and fault tolerance by distributing traffic across multiple targets and integrating with services like Auto Scaling.
Different types of load balancers (ALB, NLB, GLB) are suited for different use cases depending on the level of traffic inspection and performance needs.









Overview of Load Balancer Deployment:

1. Target Groups:
Target groups define the type of target and protocol used.
Targets can be EC2 instances, Lambda functions, or IP addresses.
Health checks determine the availability and readiness of targets, and the load balancer only forwards traffic to healthy targets.


2. VPC and Availability Zones:
Instances are deployed in a VPC and health checks are performed based on protocol and port.

3. Target Registration:
Manual registration of targets or automatic registration via Auto Scaling Groups (ASG).

4. Load Balancer and Listener:
The load balancer listens on a defined protocol/port.
The protocol/port can differ from the target group's protocol/port.

5. Routing and Encryption:
Routing rules can be applied for advanced traffic management.
SSL/TLS certificates can be assigned for encryption.


Supported Configurations for ALB vs NLB:

1. Application Load Balancer (ALB):

Supported Target Types: EC2 instances, IP addresses, Lambda functions.
Protocol: Must be HTTP or HTTPS.
Health Check Protocol: Must be HTTP or HTTPS (TCP is not supported).
Advanced Request Routing: Supports path-based and host-based routing.


2. Network Load Balancer (NLB):

Supported Target Types: EC2 instances, IP addresses, Application Load Balancers.
Protocol: Must be TCP or UDP.
Health Check Protocol: Any protocol is supported (e.g., TCP, HTTP).
Elastic IPs: NLB supports Elastic IPs per subnet for static public IP addresses.
No Advanced Request Routing: Unlike ALB, NLB does not support advanced request routing but can create multiple listeners for different ports.

_______________________________________

Advanced Request Routing (ALB):

ALB supports advanced request routing features, such as:
Path-based routing: Routing based on the URL path (e.g., /api to one backend, /images to another).
Host-based routing: Routing based on the hostname or subdomain (e.g., api.example.com to one backend, www.example.com to another).
Header-based or query-string-based routing: Routing based on HTTP headers or query parameters in the request.

These features allow ALB to inspect the HTTP/HTTPS request at the application layer (Layer 7) and route traffic to the appropriate
backend service based on the content of the request.



No Advanced Request Routing (NLB):

NLB, on the other hand, does not support the same level of advanced routing based on request content (like URL paths, hostnames, headers, etc.) because 
it operates at Layer 4 (Transport Layer), which focuses on handling TCP/UDP traffic.
Instead, NLB performs simple routing based on IP protocol (source/destination IP addresses and ports) without inspecting the content of the request.

Listeners in NLB:

While NLB does not offer advanced routing capabilities, it can create multiple listeners for different ports.
A listener is a process that checks for incoming connection requests. NLB can have listeners for different ports (e.g., port 80 for HTTP, 
port 443 for HTTPS, port 8080 for custom applications, etc.).
Each listener can route traffic to a target group based on the port, but it will not inspect the request further for advanced routing decisions.

External Targets:
NLB can route traffic to on-premises data centers or targets outside of the VPC.

_____________________________________________________________________



Source IP Address:

ALB: Uses the private IP address of the load balancer node as the source IP.
NLB: When targets are registered by instance ID, the client's IP address is visible to the application (important for logging and security).(wchi means while creating target if we
select instances then we can see the ip if we seelct ip then we wont)
When registered by IP address, the IP seen by the application is the IP address of the load balancer node.



Handling Source IP Addresses:

ALB:
The X-Forwarded-For header can be used to capture the client's IP address when using ALB.

NLB:
The source IP for clients is either the load balancer node IP or the client's IP address depending on target registration (instance ID or IP address).
When using VPC Endpoint or Global Accelerator, the source IPs are the private IPs of the NLB nodes.



Key Differences Between ALB and NLB:

Feature	Application
                              Load Balancer (ALB)	                    Network Load Balancer (NLB)
Target Types:          EC2 instances, IP addresses, Lambda functions	      EC2 instances, IP addresses, ALBs (for chaining)
Protocol               HTTP, HTTPS                                          TCP, UDP
Health Check Protocol	 HTTP, HTTPS	                                        Any protocol (TCP, HTTP, etc.)
Elastic IP	           Not supported  	                                    Supported per subnet
Advanced Routing	     Path-based, Host-based routing	                      Not supported
Use Cases	             Web applications, Microservices, Lambda	            High performance, Low latency applications
Listener	             HTTP, HTTPS                                         	TCP, UDP
Source IP	             Private IP of the Load Balancer node	                 Client's IP or Load Balancer node IP (depends on registration)
